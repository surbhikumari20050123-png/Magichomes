<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MagicHome — My Bookings</title><link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"><link rel="stylesheet" href="/assets/styles.css"/></head>
      <a class="navlink" href="index.html">Home</a><a class="navlink" href="apartments.html">Apartments</a><a class="navlink" href="owner.html">Owner</a><a class="navlink" href="admin.html">Admin</a><a class="navlink" href="login.html" id="loginBtn">Login</a>
<main class="max-w-5xl mx-auto px-4 py-6"><h1 class="text-2xl font-bold mb-3">My Bookings</h1><div id="list" class="space-y-3"></div></main>
<script type="module">import {getToken, ensureLoginOrRedirect, clearToken, updateAuthUI, money} from '/assets/common.js'; function logout(){ clearToken(); location.reload(); } if(!ensureLoginOrRedirect()) return; function load(){ fetch('/api/me/bookings?token='+encodeURIComponent(getToken())).then(r=>r.json()).then(d=>{ const box=document.getElementById('list'); if(!d.items.length){ box.innerHTML = "<div class='text-gray-600'>No bookings yet.</div>"; return; } box.innerHTML = d.items.map(b=>`<div class='p-4 border rounded card'><div class='flex items-center justify-between'><div><div class='font-semibold'>${b.title}</div><div class='text-sm text-gray-600'>${b.address}</div><div class='text-sm'>Status: <b>${b.status}</b> · Token ₹${money(b.token_amount)}</div></div><div class='flex gap-2'>${b.status==="confirmed" ? `<button class='px-3 py-2 bg-gray-900 text-white rounded' onclick='cancelB("${b.id}")'>Cancel</button>` : ""}</div></div></div>`).join(''); }); } window.cancelB=(id)=>{ fetch(`/api/bookings/${id}/cancel`,{method:"POST",headers:{'Content-Type':'application/json'},body:JSON.stringify({ token: getToken() })}).then(r=>r.json()).then(d=>{ alert(d.message||d.error); load(); }); }; load(); updateAuthUI();</script></body></html>
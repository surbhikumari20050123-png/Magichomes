<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MagicHome â€” Owner Dashboard</title><link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"><link rel="stylesheet" href="/assets/styles.css"/></head>
      <a class="navlink" href="index.html">Home</a><a class="navlink" href="admin.html">Admin</a><a class="navlink" href="login.html" id="loginBtn">Login</a>
<main class="max-w-5xl mx-auto px-4 py-6"><h1 class="text-2xl font-bold mb-3">Owner Dashboard</h1><div class="card bg-white p-4 mb-4"><h3 class="font-semibold mb-2">KYC Verification</h3><button class="px-3 py-2 btn-primary rounded" id="kycBtn">Verify KYC</button><div id="kycStatus" class="text-sm text-gray-600 mt-2"></div></div>
<div class="grid md:grid-cols-2 gap-4"><div class="card bg-white p-4"><h3 class="font-semibold mb-2">Post New Listing</h3><div class="grid grid-cols-2 gap-2"><input id="title" class="border p-2 rounded" placeholder="Title"/><select id="city" class="border p-2 rounded"></select><select id="locality" class="border p-2 rounded"></select><input id="rent" type="number" class="border p-2 rounded" placeholder="Rent"/><input id="bhk" type="number" class="border p-2 rounded" placeholder="BHK"/><label class="flex items-center gap-2"><input id="furnished" type="checkbox"/>Furnished</label></div><textarea id="desc" class="border p-2 rounded w-full mt-2" placeholder="Description"></textarea><button class="px-3 py-2 btn-primary rounded mt-3" id="postBtn">Publish</button><div id="postMsg" class="text-sm text-gray-600 mt-2"></div></div><div class="card bg-white p-4"><h3 class="font-semibold mb-2">My Listings</h3><div id="listings" class="space-y-2"></div></div></div></main>
<script type="module">import {getToken, ensureLoginOrRedirect, updateAuthUI, clearToken} from '/assets/common.js'; function logout(){ clearToken(); location.reload(); } if(!ensureLoginOrRedirect()) return; document.getElementById('kycBtn').onclick=()=>{ fetch('/api/owner/kyc',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({ token: getToken() })}).then(r=>r.json()).then(d=>{ document.getElementById('kycStatus').textContent='KYC Verified'; }); }; fetch('/api/meta/cities').then(r=>r.json()).then(d=>{ const csel=document.getElementById('city'); const lsel=document.getElementById('locality'); csel.innerHTML=d.items.map(x=>`<option>${x.city}</option>`).join(''); csel.onchange=()=>{ const entry=d.items.find(x=>x.city===csel.value); lsel.innerHTML=entry.localities.map(l=>`<option>${l}</option>`).join(''); }; csel.dispatchEvent(new Event('change')); }); document.getElementById('postBtn').onclick=()=>{ const data={ title: document.getElementById('title').value || 'Owner Listing', city: document.getElementById('city').value, locality: document.getElementById('locality').value, rent: Number(document.getElementById('rent').value||25000), bhk: Number(document.getElementById('bhk').value||2), furnished: document.getElementById('furnished').checked, description: document.getElementById('desc').value||'', images: [] }; fetch('/api/owner/listings',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({ token:getToken(), data })}).then(r=>r.json()).then(d=>{ document.getElementById('postMsg').textContent = d.ok ? ('Listing published: '+d.id) : (d.error||'Failed'); }); }; updateAuthUI();</script></body></html>